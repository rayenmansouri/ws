server{
    listen 80;

    server_name *.staging.webschoool.com;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    location / {
        return 301 https://$uri$request_uri;
    }
}

server {
  listen 443 ssl;

  ssl_certificate /etc/nginx/ssl/live/staging.webschoool.com/fullchain.pem;
  ssl_certificate_key /etc/nginx/ssl/live/staging.webschoool.com/privkey.pem;

  server_name *.staging.webschoool.com;
  root /usr/share/websites/staging/apps/;
  
  location /.well-known/assetlinks.json {
    alias /usr/share/websites/staging/apps/portal/.well-known/assetlinks-staging.json;
  }

  location /admin {
    alias /usr/share/websites/staging/apps/admin;
    try_files $uri $uri/ /admin/index.html;
  }

  location /teacher {
    alias /usr/share/websites/staging/apps/teacher;
    try_files $uri $uri/ /teacher/index.html;
  }

  location /student {
    alias /usr/share/websites/staging/apps/student;
    try_files $uri $uri/ /student/index.html;
  }

  location /parent {
    alias /usr/share/websites/staging/apps/parent;
    try_files $uri $uri/ /parent/index.html;
  }

  location / {
    root /usr/share/websites/staging/apps/portal;
    try_files $uri $uri/ /index.html;
  }

}
